import os
import random
import threading
from http.server import BaseHTTPRequestHandler, HTTPServer
from telegram import Update
from telegram.ext import ApplicationBuilder, MessageHandler, CommandHandler, filters, ContextTypes

# =======================
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏
# =======================
TELEGRAM_TOKEN = "8456574639:AAF67RT8myD5CNe8RmiHh9DrbT-ZkwvstDc"  # –≤—Å—Ç–∞–≤—å —Å—é–¥–∞ —Å–≤–æ–π —Ç–æ–∫–µ–Ω

TARGET_USERNAMES = ["Habib471"]
SIGNATURE = "–ü–æ–ª—é–±–∏ –ê–ø–∞—á–∏, –∫–∞–∫ –æ–Ω —Ç–µ–±—è"

bot_active = True  # —Ñ–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞

# =======================
# –§—Ä–∞–∑—ã (100 –∫—Ä–∞—Å–∏–≤—ã—Ö)
# =======================
LOVE_PHRASES = [
    "–¢—ã ‚Äî —Å–≤–µ—Ç –º–æ–µ–π –¥—É—à–∏.",
    "–° —Ç–æ–±–æ–π –∫–∞–∂–¥—ã–π –º–∏–≥ ‚Äî —á—É–¥–æ.",
    "–¢–≤–æ—è —É–ª—ã–±–∫–∞ —Å–æ–≥—Ä–µ–≤–∞–µ—Ç —Å–µ—Ä–¥—Ü–µ.",
    "–¢—ã ‚Äî –º–æ–π —Ç–∏—Ö–∏–π –æ–∫–µ–∞–Ω —Å—á–∞—Å—Ç—å—è.",
    "–° —Ç–æ–±–æ–π –º–∏—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —è—Ä—á–µ.",
    "–¢—ã ‚Äî –¥—ã—Ö–∞–Ω–∏–µ –º–æ–µ–π —Ä–∞–¥–æ—Å—Ç–∏.",
    "–í —Ç–≤–æ–∏—Ö –≥–ª–∞–∑–∞—Ö —Ü–µ–ª–∞—è –≤—Å–µ–ª–µ–Ω–Ω–∞—è.",
    "–¢—ã ‚Äî –º–æ—è –º–µ–ª–æ–¥–∏—è –±–µ–∑ —Å–ª–æ–≤.",
    "–° —Ç–æ–±–æ–π –¥–∞–∂–µ —Ç–∏—à–∏–Ω–∞ –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞.",
    "–¢—ã ‚Äî —Å–º—ã—Å–ª –º–æ–∏—Ö –¥–Ω–µ–π.",
    "–¢–≤–æ—è –ª—é–±–æ–≤—å –æ–∫—Ä—ã–ª—è–µ—Ç –º–µ–Ω—è.",
    "–¢—ã ‚Äî –ª—É—á —Å–æ–ª–Ω—Ü–∞ –≤ –º–æ—ë–º —Å–µ—Ä–¥—Ü–µ.",
    "–° —Ç–æ–±–æ–π –∫–∞–∂–¥–∞—è –º–∏–Ω—É—Ç–∞ ‚Äî —Å—á–∞—Å—Ç—å–µ.",
    "–¢—ã ‚Äî –º–æ—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –≤–µ—Å–Ω–∞.",
    "–¢–≤–æ—è –Ω–µ–∂–Ω–æ—Å—Ç—å –ª–µ—á–∏—Ç –¥—É—à—É.",
    "–¢—ã ‚Äî –º–æ–π —è–∫–æ—Ä—å –∏ –º–æ–π –ø–æ–ª—ë—Ç.",
    "–° —Ç–æ–±–æ–π —Ö–æ—á–µ—Ç—Å—è –∂–∏—Ç—å –∏ –º–µ—á—Ç–∞—Ç—å.",
    "–¢—ã ‚Äî –º–æ—è —Ç–∏—Ö–∞—è –≥–∞–≤–∞–Ω—å.",
    "–¢–≤–æ–∏ —Å–ª–æ–≤–∞ ‚Äî –º—É–∑—ã–∫–∞ –¥–ª—è —Å–µ—Ä–¥—Ü–∞.",
    "–¢—ã ‚Äî —á—É–¥–æ, —á—Ç–æ —Å—Ç–∞–ª–æ —è–≤—å—é.",
    "–° —Ç–æ–±–æ–π –º–∏—Ä –ø–æ–ª–æ–Ω –º–∞–≥–∏–∏.",
    "–¢—ã ‚Äî –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π –º—ã—Å–ª–∏.",
    "–¢–≤–æ—è –ª—é–±–æ–≤—å ‚Äî –º–æ–π —Å–≤–µ—Ç–ª—ã–π –ø—É—Ç—å.",
    "–¢—ã ‚Äî –º–æ—è —Å–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å.",
    "–° —Ç–æ–±–æ–π —è –≤–∏–∂—É —Å–º—ã—Å–ª –≤–æ –≤—Å—ë–º.",
    "–¢—ã ‚Äî –º—è–≥–∫–∏–π —à—ë–ø–æ—Ç —Å—á–∞—Å—Ç—å—è.",
    "–¢–≤–æ—è —É–ª—ã–±–∫–∞ ‚Äî –º–æ–π –º–∞—è–∫.",
    "–¢—ã ‚Äî —Ç–µ–ø–ª–∞—è –≤–µ—Å–Ω–∞ –º–æ–µ–π –¥—É—à–∏.",
    "–° —Ç–æ–±–æ–π –¥–∞–∂–µ –¥–æ–∂–¥—å –∑–≤—É—á–∏—Ç –∫–∞–∫ –ø–µ—Å–Ω—è.",
    "–¢—ã ‚Äî –º–æ—è –≥–∞—Ä–º–æ–Ω–∏—è –≤ —Ö–∞–æ—Å–µ.",
    "–¢–≤–æ–∏ –≥–ª–∞–∑–∞ ‚Äî –º–æ–π —Ü–µ–ª—ã–π –∫–æ—Å–º–æ—Å.",
    "–¢—ã ‚Äî –º—è–≥–∫–∏–π —Å–≤–µ—Ç –≤ —Ç–µ–º–Ω–æ—Ç–µ.",
    "–° —Ç–æ–±–æ–π —Ö–æ—á–µ—Ç—Å—è —Ç–≤–æ—Ä–∏—Ç—å —á—É–¥–µ—Å–∞.",
    "–¢—ã ‚Äî –¥—ã—Ö–∞–Ω–∏–µ –ª—é–±–≤–∏.",
    "–¢–≤–æ—è –±–ª–∏–∑–æ—Å—Ç—å ‚Äî —Ä–∞–¥–æ—Å—Ç—å —Å–µ—Ä–¥—Ü–∞.",
    "–¢—ã ‚Äî –º–æ—è —Ç–∏—Ö–∞—è —Ä–∞–¥–æ—Å—Ç—å.",
    "–° —Ç–æ–±–æ–π –≤—Å—ë –≤–æ–∫—Ä—É–≥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º—è–≥—á–µ.",
    "–¢—ã ‚Äî —Ç–µ–ø–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ —É—Ö–æ–¥–∏—Ç.",
    "–¢–≤–æ—è –Ω–µ–∂–Ω–æ—Å—Ç—å ‚Äî –º–æ–π –¥–æ–º.",
    "–¢—ã ‚Äî —Å–º—ã—Å–ª –º–æ–∏—Ö —É–ª—ã–±–æ–∫.",
    "–° —Ç–æ–±–æ–π —è —á—É–≤—Å—Ç–≤—É—é –ø–æ–ª–Ω–æ–µ —Å—á–∞—Å—Ç—å–µ.",
    "–¢—ã ‚Äî —É—Ç—Ä–µ–Ω–Ω–∏–π —Ä–∞—Å—Å–≤–µ—Ç –º–æ–µ–π –¥—É—à–∏.",
    "–¢–≤–æ—è –ª—é–±–æ–≤—å –æ–∫—É—Ç—ã–≤–∞–µ—Ç –º–µ–Ω—è.",
    "–¢—ã ‚Äî –º–æ–π —Å–≤–µ—Ç –≤ –∫–∞–∂–¥–æ–º –¥–Ω–µ.",
    "–° —Ç–æ–±–æ–π —Ö–æ—á–µ—Ç—Å—è –ª–µ—Ç–µ—Ç—å.",
    "–¢—ã ‚Äî –º—É–∑—ã–∫–∞ –º–æ–µ–π –∂–∏–∑–Ω–∏.",
    "–¢–≤–æ–∏ —Å–ª–æ–≤–∞ —Å–æ–≥—Ä–µ–≤–∞—é—Ç —Å–µ—Ä–¥—Ü–µ.",
    "–¢—ã ‚Äî –º–∞–ª–µ–Ω—å–∫–æ–µ —á—É–¥–æ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.",
    "–° —Ç–æ–±–æ–π —Ö–æ—á–µ—Ç—Å—è —É–ª—ã–±–∞—Ç—å—Å—è –±–µ–∑ –ø—Ä–∏—á–∏–Ω—ã.",
    "–¢—ã ‚Äî –∞—Ä–æ–º–∞—Ç —Å—á–∞—Å—Ç—å—è –≤ –º–æ–µ–π –¥—É—à–µ.",
    "–¢–≤–æ–∏ –≥–ª–∞–∑–∞ ‚Äî –º–æ–µ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ.",
    "–¢—ã ‚Äî –º–æ–π —É—é—Ç –≤ –º–∏—Ä–µ —Å—É–º—Ä–∞–∫–∞.",
    "–° —Ç–æ–±–æ–π —è —Ö–æ—á—É –±—ã—Ç—å –≤–µ—á–Ω–æ—Å—Ç—å.",
    "–¢—ã ‚Äî –º–æ—è –Ω–µ–∂–Ω–∞—è —Å–∏–º—Ñ–æ–Ω–∏—è.",
    "–¢–≤–æ–∏ –ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏—è ‚Äî —Å–≤–µ—Ç –¥—É—à–∏.",
    "–¢—ã ‚Äî –º–µ—á—Ç–∞, —á—Ç–æ —Å—Ç–∞–ª–∞ —è–≤—å—é.",
    "–° —Ç–æ–±–æ–π –∂–∏–∑–Ω—å –Ω–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–º—ã—Å–ª–æ–º.",
    "–¢—ã ‚Äî –º—è–≥–∫–æ—Å—Ç—å, —á—Ç–æ –ª–µ—á–∏—Ç —Å–µ—Ä–¥—Ü–µ.",
    "–¢–≤–æ—è –ª—é–±–æ–≤—å ‚Äî –º–æ—è –≤–µ—á–Ω–∞—è –≤–µ—Å–Ω–∞.",
    "–¢—ã ‚Äî —Ç–∏—Ö–∏–π —Å–≤–µ—Ç, —á—Ç–æ –≤–µ–¥–µ—Ç –º–µ–Ω—è.",
    "–° —Ç–æ–±–æ–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî –ø—Ä–∞–∑–¥–Ω–∏–∫.",
    "–¢—ã ‚Äî —Ä–∞–¥–æ—Å—Ç—å, —á—Ç–æ –Ω–µ–ª—å–∑—è –∑–∞–±—ã—Ç—å.",
    "–¢–≤–æ–∏ —Å–ª–æ–≤–∞ ‚Äî –∏—Å–∫—Ä–∞ –≤ –º–æ—ë–º —Å–µ—Ä–¥—Ü–µ.",
    "–¢—ã ‚Äî –º—è–≥–∫–∏–π —à—ë–ø–æ—Ç –º–æ–µ–π –¥—É—à–∏.",
    "–° —Ç–æ–±–æ–π –º–∏—Ä –æ–±—Ä–µ—Ç–∞–µ—Ç —Å–º—ã—Å–ª.",
    "–¢—ã ‚Äî –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ, —á—Ç–æ –æ–∂–∏–≤–ª—è–µ—Ç –º–µ–Ω—è.",
    "–¢–≤–æ—è –ª—é–±–æ–≤—å ‚Äî –º–æ—è —Ç–∏—Ö–∞—è –≥–∞–≤–∞–Ω—å.",
    "–¢—ã ‚Äî –¥—ã—Ö–∞–Ω–∏–µ —Å—á–∞—Å—Ç—å—è –≤ —Å–µ—Ä–¥—Ü–µ.",
    "–° —Ç–æ–±–æ–π –¥–∞–∂–µ —Ç–∏—à–∏–Ω–∞ –∑–≤—É—á–∏—Ç.",
    "–¢—ã ‚Äî —Å–≤–µ—Ç, —á—Ç–æ –Ω–µ —É–≥–∞—Å–∞–µ—Ç.",
    "–¢–≤–æ–∏ –≥–ª–∞–∑–∞ ‚Äî –º–æ–π —Å–≤–µ—Ç–ª—ã–π –∫–æ—Å–º–æ—Å.",
    "–¢—ã ‚Äî –º–æ–π –∫–æ–º–ø–∞—Å –≤ –∂–∏–∑–Ω–∏.",
    "–° —Ç–æ–±–æ–π —Ö–æ—á—É –¥–µ–ª–∏—Ç—å –∫–∞–∂–¥—ã–π –º–∏–≥.",
    "–¢—ã ‚Äî —É—Ç—Ä–µ–Ω–Ω–∏–π –ª—É—á –Ω–∞–¥–µ–∂–¥—ã.",
    "–¢–≤–æ—è –Ω–µ–∂–Ω–æ—Å—Ç—å ‚Äî –º–æ–π –æ—Å—Ç—Ä–æ–≤ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è.",
    "–¢—ã ‚Äî –º—è–≥–∫–∏–π –¥–æ–∂–¥—å —Ä–∞–¥–æ—Å—Ç–∏.",
    "–° —Ç–æ–±–æ–π –¥–∞–∂–µ –≤–µ—Ç–µ—Ä –ø—Ä–∏–Ω–æ—Å–∏—Ç —Å—á–∞—Å—Ç—å–µ.",
    "–¢—ã ‚Äî –º–æ–π —Ç–∏—Ö–∏–π –æ–∫–µ–∞–Ω.",
    "–¢–≤–æ–∏ —Å–ª–æ–≤–∞ ‚Äî –º—É–∑—ã–∫–∞ —Å–µ—Ä–¥—Ü–∞.",
    "–¢—ã ‚Äî –º—è–≥–∫–∞—è —Ä–∞–¥–æ—Å—Ç—å –≤ –º–∏—Ä–µ.",
    "–° —Ç–æ–±–æ–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å —Å–ª–æ–≤–Ω–æ —Å–∫–∞–∑–∫–∞.",
    "–¢—ã ‚Äî –¥—ã—Ö–∞–Ω–∏–µ —Å–≤–µ—Ç–∞ –≤ –¥—É—à–µ.",
    "–¢–≤–æ—è —É–ª—ã–±–∫–∞ ‚Äî –º–æ–π —Å–æ–ª–Ω–µ—á–Ω—ã–π –ª—É—á.",
    "–¢—ã ‚Äî —Ä–∞–¥–æ—Å—Ç—å, —á—Ç–æ –Ω–µ –∫–æ–Ω—á–∞–µ—Ç—Å—è.",
    "–° —Ç–æ–±–æ–π –∂–∏–∑–Ω—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–∞–≥–∏–µ–π.",
    "–¢—ã ‚Äî –º–æ—è —Ç–∏—Ö–∞—è –≤–µ—Å–Ω–∞.",
    "–¢–≤–æ–∏ –ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏—è ‚Äî —Ç–µ–ø–ª–æ —Å–µ—Ä–¥—Ü–∞.",
    "–¢—ã ‚Äî —Å–≤–µ—Ç–ª–æ–µ —á—É–¥–æ –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è.",
    "–° —Ç–æ–±–æ–π –º–∏—Ä –Ω–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≥–∞—Ä–º–æ–Ω–∏–µ–π.",
    "–¢—ã ‚Äî –º—è–≥–∫–∞—è —Å–∏–º—Ñ–æ–Ω–∏—è –ª—é–±–≤–∏.",
    "–¢–≤–æ—è –ª—é–±–æ–≤—å ‚Äî –º–æ–π —É—Ç—Ä–µ–Ω–Ω–∏–π —Å–≤–µ—Ç.",
    "–¢—ã ‚Äî —Ç–∏—Ö–∏–π —à—ë–ø–æ—Ç —Ä–∞–¥–æ—Å—Ç–∏.",
    "–° —Ç–æ–±–æ–π –¥–∞–∂–µ —Å–µ—Ä—ã–µ –¥–Ω–∏ —è—Ä—á–µ.",
    "–¢—ã ‚Äî –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –±–µ–∑ –≥—Ä–∞–Ω–∏—Ü.",
    "–¢–≤–æ–∏ –≥–ª–∞–∑–∞ ‚Äî –æ–∫–µ–∞–Ω –Ω–µ–∂–Ω–æ—Å—Ç–∏.",
    "–¢—ã ‚Äî –º–æ—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –º–µ–ª–æ–¥–∏—è.",
    "–° —Ç–æ–±–æ–π –∫–∞–∂–¥—ã–π –º–∏–≥ ‚Äî —Å–≤–µ—Ç.",
    "–¢—ã ‚Äî –¥—ã—Ö–∞–Ω–∏–µ –≤–µ—Å–Ω—ã –≤ —Å–µ—Ä–¥—Ü–µ.",
    "–¢–≤–æ—è –ª—é–±–æ–≤—å ‚Äî –º–æ–π —Ç–∏—Ö–∏–π –º–∞—è–∫.",
    "–¢—ã ‚Äî —Ä–∞–¥–æ—Å—Ç—å, —á—Ç–æ —Å–æ–≥—Ä–µ–≤–∞–µ—Ç –¥—É—à—É.",
    "–° —Ç–æ–±–æ–π –º–∏—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º—è–≥–∫–∏–º.",
    "–¢—ã ‚Äî –º–æ–µ —É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–ª–Ω—Ü–µ.",
    "–¢–≤–æ–∏ —Å–ª–æ–≤–∞ ‚Äî —Å–≤–µ—Ç –≤ —Ç–µ–º–Ω–æ—Ç–µ.",
    "–¢—ã ‚Äî –º—è–≥–∫–æ—Å—Ç—å, —á—Ç–æ –æ–∂–∏–≤–ª—è–µ—Ç —Å–µ—Ä–¥—Ü–µ.",
    "–° —Ç–æ–±–æ–π —Ö–æ—á–µ—Ç—Å—è –±—ã—Ç—å –≤–µ—á–Ω–æ."
]

LOVE_JOKES = [
    "–¢—ã –∫–∞–∫ Wi-Fi ‚Äî –∫–æ–≥–¥–∞ —Ç–µ–±—è —Ä—è–¥–æ–º, –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ üòÑ",
    "–¢—ã ‚Äî –º–æ—è –±–∞—Ç–∞—Ä–µ–π–∫–∞, –±–µ–∑ —Ç–µ–±—è —è —Ç–µ—Ä—è—é –∑–∞—Ä—è–¥ ‚ù§Ô∏è",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª –∫–æ—Ñ–µ, —è –±—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–æ—Å—ã–ø–∞–ª—Å—è –±–µ–∑ —Ç–µ–±—è ‚òï",
    "–¢—ã –∫–∞–∫ –ø–∞—Ä–æ–ª—å: —Å–ª–æ–∂–Ω—ã–π, –Ω–æ –±–µ–∑ —Ç–µ–±—è –∂–∏–∑–Ω—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞ üîë",
    "–¢—ã ‚Äî –º–æ—è –ª—é–±–∏–º–∞—è –ø–µ—Å–Ω—è, –∫–æ—Ç–æ—Ä—É—é —è —Ö–æ—á—É —Å–ª—É—à–∞—Ç—å –Ω–∞ –ø–æ–≤—Ç–æ—Ä–µ üé∂",
]

# =======================
# –ú–∏–Ω–∏-–≤–µ–±-—Å–µ—Ä–≤–µ—Ä
# =======================
def run_web():
    class Handler(BaseHTTPRequestHandler):
        def do_GET(self):
            self.send_response(200)
            self.end_headers()
            self.wfile.write(b"LoveBot is running <3")
    port = int(os.environ.get("PORT", 10000))
    HTTPServer(("0.0.0.0", port), Handler).serve_forever()

threading.Thread(target=run_web, daemon=True).start()

# =======================
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è, —á—Ç–æ–±—ã –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—å
# =======================
last_messages = {}

# =======================
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥
# =======================
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(
        "üíû –ü—Ä–∏–≤–µ—Ç! –Ø LoveBot by Apachi.\n"
        "–Ø –æ—Ç–≤–µ—á–∞—é –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π üíå\n"
        "–ö–æ–º–∞–Ω–¥–æ–π /love –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å!\n"
        "–ö–æ–º–∞–Ω–¥–æ–π /on –∏ /off –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å –∏ –≤—ã–∫–ª—é—á–∞—Ç—å –±–æ—Ç–∞"
    )

async def love_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    message = update.message
    args = message.text.split(maxsplit=1)
    target = args[1] if len(args) > 1 else message.from_user.username
    score = random.randint(0, 100)
    comment = random.choice([
        "üî• –õ—é–±–æ–≤—å –≥–æ—Ä–∏—Ç!",
        "üíñ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∫–æ—Å–º–∏—á–µ—Å–∫–∞—è!",
        "üíû –°—É–¥—å–±–∞ —É–ª—ã–±–∞–µ—Ç—Å—è –≤–∞–º!",
        "üíå –ò–¥–µ–∞–ª—å–Ω–∞—è –ø–∞—Ä–∞!",
        "üåπ –¶–≤–µ—Ç–µ—Ç —Å–µ—Ä–¥—Ü–µ!"
    ])
    await message.reply_text(f"üíû –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å {target}: {score}%\n{comment}")

async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    global bot_active
    if not bot_active:
        return

    message = update.message
    if not message or not message.from_user:
        return
    username = message.from_user.username
    phrase = None
    if message.chat.type in ["group", "supergroup", "private"]:
        if username in TARGET_USERNAMES and random.random() < 0.3:
            if random.random() < 0.2:
                while True:
                    phrase = random.choice(LOVE_JOKES)
                    if last_messages.get(username) != phrase:
                        last_messages[username] = phrase
                        break
            else:
                while True:
                    phrase = random.choice(LOVE_PHRASES)
                    if last_messages.get(username) != phrase:
                        last_messages[username] = phrase
                        break
            response = phrase + f"\n\n{SIGNATURE}"
            await message.reply_text(response, reply_to_message_id=message.message_id)

async def bot_on(update: Update, context: ContextTypes.DEFAULT_TYPE):
    global bot_active
    bot_active = True
    await update.message.reply_text("‚úÖ –ë–æ—Ç –≤–∫–ª—é—á–µ–Ω!")

async def bot_off(update: Update, context: ContextTypes.DEFAULT_TYPE):
    global bot_active
    bot_active = False
    await update.message.reply_text("‚õî –ë–æ—Ç –≤—ã–∫–ª—é—á–µ–Ω!")

# =======================
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
# =======================
async def main():
    app = ApplicationBuilder().token(TELEGRAM_TOKEN).build()
    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("love", love_command))
    app.add_handler(CommandHandler("on", bot_on))
    app.add_handler(CommandHandler("off", bot_off))
    app.add_handler(MessageHandler(filters.TEXT & (~filters.COMMAND), handle_message))
    await app.run_polling()

if __name__ == "__main__":
    import asyncio
    asyncio.run(main())
