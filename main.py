import os
import random
import threading
from http.server import BaseHTTPRequestHandler, HTTPServer
from telegram import Update
from telegram.ext import ApplicationBuilder, MessageHandler, CommandHandler, filters, ContextTypes

# ะะพะปัะทะพะฒะฐัะตะปั, ะบะพัะพัะพะผั ะฑะพั ะพัะฒะตัะฐะตั ะฝะฐ ะบะฐะถะดะพะต ัะพะพะฑัะตะฝะธะต
TARGET_USERNAMES = ["Habib471"]

# ะัะต ัะพะผะฐะฝัะธัะตัะบะธะต ััะฐะทั ๐
LOVE_PHRASES = [
    "ะขั โ ะผะพั ะฒะดะพัะฝะพะฒะตะฝะธะต, ะฝะตะถะฝะพะต ะบะฐะบ ะดััะฐะฝะธะต ะฒะตัะฝั ๐ท",
    "ะก ัะพะฑะพะน ะฒัั ะฒะพะบััะณ ะฝะฐะฟะพะปะฝัะตััั ัะผััะปะพะผ ๐ซ",
    "ะขั โ ะผะพั ะผะตะปะพะดะธั ััะฐัััั, ัะธัะฐั ะธ ะฒะตัะฝะฐั ๐ถ",
    "ะ ะบะฐะถะดะพะผ ะปััะต ัะพะปะฝัะฐ ั ะฒะธะถั ัะฒะพะน ัะฒะตั โ๏ธ",
    "ะขั โ ััะฟะพั ะฝะตะถะฝะพััะธ ะฒ ััะผะต ะผะธัะฐ ๐ธ",
    "ะะฐะถะดะฐั ะผััะปั ะพ ัะตะฑะต โ ะบะฐะบ ัััะตะฝะฝะธะน ัะฐััะฒะตั ๐",
    "ะก ัะพะฑะพะน ะดะฐะถะต ัะธัะธะฝะฐ ะทะฒััะธั ะฟัะตะบัะฐัะฝะตะต ๐",
    "ะขั โ ะดััะฐะฝะธะต ัะฒะตัะฐ ะฒ ะผะพัะผ ัะตัะดัะต โจ",
    "ะ ัะฒะพะธั ะณะปะฐะทะฐั ัะฟัััะฐะฝะพ ะฝะตะฑะพ ะธ ัะตะฟะปะพ ๐",
    "ะขั โ ะผะตััะฐ, ะบะพัะพัะฐั ััะฐะปะฐ ัะตะฐะปัะฝะพัััั ๐",
    "ะก ัะพะฑะพะน ะดะฐะถะต ะฒะตัะตั ะดััะธั ะปัะฑะพะฒัั ๐ฌ๏ธ",
    "ะขั โ ะฟัะธัะธะฝะฐ ัะปัะฑะฐัััั ะฑะตะท ะฟัะธัะธะฝั ๐",
    "ะขะฒะพั ะธะผั ะทะฒััะธั ะบะฐะบ ะฝะตะถะฝะฐั ะฟะตัะฝั ๐",
    "ะขั โ ัะฒะตัะปะฐั ะผััะปั ะฒะพ ะฒัะตั ะผะพะธั ะดะฝัั ๐ค๏ธ",
    "ะะพะณะดะฐ ัั ััะดะพะผ, ะฒัั ะพััะฐะปัะฝะพะต ัะตััะตั ะทะฝะฐัะตะฝะธะต ๐บ",
    "ะขั โ ะผะพะน ะดะพะผ, ะณะดะต ะฟะพะบะพะน ะธ ัะตะฟะปะพ ๐๏ธ",
    "ะะฐะถะดะฐั ะฒัััะตัะฐ ั ัะพะฑะพะน โ ะผะฐะปะตะฝัะบะพะต ััะดะพ โจ",
    "ะขั โ ัััะตะฝะฝะธะน ะปัั ะฒ ะผะพัะผ ัะตัะดัะต ๐",
    "ะก ัะพะฑะพะน ะดะฐะถะต ะทะฒัะทะดั ัะธััั ัััะต ๐",
    "ะขั โ ะบะฐะฟะปั ะปัะฑะฒะธ ะฒ ะพะบะตะฐะฝะต ะถะธะทะฝะธ ๐ง",
    "ะขั โ ะฒะดะพั, ะฑะตะท ะบะพัะพัะพะณะพ ะฝะต ะดััั ๐ซ",
    "ะ ัะฒะพะธั ะณะปะฐะทะฐั โ ัะตะปะฐั ะฒัะตะปะตะฝะฝะฐั ะฝะตะถะฝะพััะธ ๐",
    "ะขั โ ัะปะพะฒะพ โััะฐัััะตโ, ะฝะฐะฟะธัะฐะฝะฝะพะต ัะฒะตัะพะผ ๐",
    "ะขั โ ะผะพะน ัะบะพัั ะธ ะผะพะน ะฟะพะปัั ะพะดะฝะพะฒัะตะผะตะฝะฝะพ ๐",
    "ะขั โ ะผะพะน ััั ะดะฐะถะต ะฒ ัะฐะผัั ัะพะปะพะดะฝัั ะดะฝัั โ๏ธ",
    "ะขะฒะพั ะฟัะธัััััะฒะธะต ะดะตะปะฐะตั ััะพั ะผะธั ะผัะณัะต ๐ธ",
    "ะขั โ ัะปัะฑะบะฐ ััะดัะฑั, ะบะพัะพััั ั ะฝะต ัะพัั ัะตัััั ๐ซ",
    "ะขั โ ะฐัะพะผะฐั ะฒะตัะฝั ะฒ ะผะพะธั ะผััะปัั ๐ผ",
    "ะก ัะพะฑะพะน ะผะธั ะพะฑัะตัะฐะตั ัะธัะผั ะธ ะผัะทัะบั ๐ต",
    "ะขั โ ะผะพะน ะปััะธะบ ะฒ ะผะธัะต ััะผัะฐะบะพะฒ ๐",
    "ะขั โ ะฝะตะถะฝะพััั, ะพะฑัะตััะฐั ัะพัะผั ๐",
    "ะะฐะถะดะพะต ัััะพ ั ัะพะฑะพะน โ ะฟัะฐะทะดะฝะธะบ ะดััะธ ๐",
    "ะขั โ ัะตะฟะปะพ, ััะพ ะฝะต ััะพะดะธั ะดะฐะถะต ะทะธะผะพะน ๐ฅ",
    "ะขั โ ะผะพะน ัะผััะป ะธ ะผะพั ะฟัะพััะฐั ัะฐะดะพััั ๐",
    "ะก ัะพะฑะพะน ะดะฐะถะต ะดะพะถะดั ะฟะพัั ะพ ะปัะฑะฒะธ ๐ง๏ธ",
    "ะขั โ ะผะณะฝะพะฒะตะฝะธะต, ะบะพัะพัะพะต ัะพัะตััั ะฟะพะฒัะพัััั ๐",
    "ะขั โ ัะปะฐะดะบะธะน ัะพะฝ, ะบะพัะพััะน ะฝะต ัะพัะตััั ะฟัะตััะฒะฐัั ๐",
    "ะขั โ ะฒะดะพัะฝะพะฒะตะฝะธะต ะบะฐะถะดะพะน ัััะพะบะธ ๐ซ",
    "ะขั โ ะผะพะน ะผะฐัะบ ะฒ ะพะบะตะฐะฝะต ััะฒััะฒ ๐",
    "ะขั โ ะผัะณะบะธะน ัะฒะตั, ััะพ ะฒะตะดัั ัะบะฒะพะทั ััะผั ๐",
    "ะขั โ ััะดะพ, ะบ ะบะพัะพัะพะผั ะฝะต ะฟะตัะตััะฐั ััะฝััััั ๐",
    "ะขั โ ะดััะฐะฝะธะต ัะฐะดะพััะธ ะฒ ะบะฐะถะดะพะผ ะดะฝะต ๐",
    "ะขั โ ะพัะบะปะธะบ ัะตัะดัะฐ ะฝะฐ ะทะพะฒ ะปัะฑะฒะธ ๐",
    "ะขั โ ะฝะตะถะฝัะน ะพะณะพะฝั ะฒ ัะพะปะพะดะฝะพะผ ะผะธัะต ๐ฅ",
    "ะก ัะพะฑะพะน ะดะฐะถะต ะผะพะปัะฐะฝะธะต ััะฐะฝะพะฒะธััั ััะธัะพะผ ๐ธ",
    "ะขั โ ะผะพั ัะฐะผะฐั ะบัะฐัะธะฒะฐั ัะปััะฐะนะฝะพััั ๐ซ",
    "ะขั โ ัะฒะตั ะฒ ะบะฐะถะดะพะผ ะฒะทะณะปัะดะต ๐",
    "ะขั โ ัััะพ, ะบะพัะพัะพะต ะฝะต ัะพัะตััั ะพัะฟััะบะฐัั ๐",
    "ะขั โ ะฟัะธัะธะฝะฐ ะผะพะตะณะพ ะฒะดะพัะฐ ะธ ัะปัะฑะบะธ ๐",
    "ะก ัะพะฑะพะน ะฒัั ะฟัะพััะพ ะธ ะฒัั ะฟะพ-ะฝะฐััะพััะตะผั โ๏ธ",
    "ะขั โ ะผะพะน ััะธั, ะฝะฐะฟะธัะฐะฝะฝัะน ะทะฒัะทะดะฐะผะธ ๐",
    "ะขั โ ะฟัะธะบะพัะฝะพะฒะตะฝะธะต ัะฒะตัะฐ ะบ ะดััะต ๐ซ",
    "ะขั โ ะฟะตัะฝั, ััะพ ะทะฒััะธั ะฑะตะท ัะปะพะฒ ๐ถ",
    "ะขั โ ะดััะฐะฝะธะต ัะตะฟะปะฐ ะฒ ะผะพัะผ ัะตัะดัะต ๐",
    "ะขั โ ัะปัะฑะบะฐ, ะทะฐ ะบะพัะพัะพะน ัะบัััะพ ัะพะปะฝัะต โ๏ธ",
    "ะขั โ ะผะพะน ะฒะฝัััะตะฝะฝะธะน ะฟะพะบะพะน ๐",
    "ะขั โ ะบะฐะบ ะปะตัะพ ะฒ ัะตัะดัะต ะทะธะผะพะน ๐บ",
    "ะขั โ ัะฒะตัะปะฐั ะฝะพัะฐ ะผะพะตะณะพ ะดะฝั ๐ต",
    "ะขั โ ะผะพะน ะฝะตะถะฝัะน ะผะฐัะบ ะฒ ะฑััะต ะถะธะทะฝะธ ๐",
    "ะขั โ ัะตะฟะพั, ััะพ ะปะตัะธั ะดััั ๐",
    "ะขั โ ะผะพั ะฑะตัะบะพะฝะตัะฝะพััั ะฒ ะพะดะฝะพะผ ะฒะทะณะปัะดะต ๐ซ",
    "ะขั โ ัะผััะป, ััะพ ะดะตะปะฐะตั ะฒัั ะพััะฐะปัะฝะพะต ะฝะตะฝัะถะฝัะผ ๐",
    "ะขั โ ะผะพะน ะฐะฝะณะตะป ััะตะดะธ ะปัะดะตะน ๐๏ธ",
    "ะขั โ ะดััะฐะฝะธะต ััะฐัััั ๐",
    "ะขั โ ะบะฐะบ ััะธั, ะบะพัะพััะน ัะพัะตััั ะฟะตัะตัะธััะฒะฐัั ๐ธ",
    "ะขั โ ัะปัะฑะบะฐ, ัะพะณัะตะฒะฐััะฐั ัะตัะดัะต ๐",
    "ะขั โ ะฒะดะพัะฝะพะฒะตะฝะธะต ะผะพะตะณะพ ะฒะดะพัะฐ ๐ซ",
    "ะขั โ ะผะตััะฐ, ะบ ะบะพัะพัะพะน ะฒะตะดัั ะฒัะต ะฟััะธ ๐",
    "ะขั โ ะฝะตะถะฝะพััั, ะพะฑะตัะฝััะฐั ะฒ ัะฒะตั ๐ท",
    "ะขั โ ะผะพะน ัะฐััะฒะตั ะธ ะผะพะน ะทะฐะบะฐั ะพะดะฝะพะฒัะตะผะตะฝะฝะพ ๐",
    "ะขั โ ะผะพะน ะพัะฒะตั ะฝะฐ ะฒัะต ะฒะพะฟัะพัั ๐",
    "ะขั โ ััะดะพ, ะพ ะบะพัะพัะพะผ ั ะผะพะปัะฐะป ๐",
    "ะขั โ ะฝะตะถะฝะพััั, ััะพ ะถะธะฒัั ะฒ ะบะฐะถะดะพะผ ะผะณะฝะพะฒะตะฝะธะธ ๐",
    "ะขั โ ะดััะฐะฝะธะต ะฒะตัะฝั ะฒ ัะพะปะพะดะฝะพะผ ะดะฝะต ๐ธ",
    "ะขั โ ัะตะฟะปะพ, ัะฟัััะฐะฝะฝะพะต ะฒ ะผะพะธั ะผััะปัั โ๏ธ",
    "ะขั โ ะผะพะน ะปัะฑะธะผัะน ัะฐะพั ๐ซ",
    "ะขั โ ะฟะพัะตะปัะน ััะดัะฑั, ะพััะฐะฒัะธะนัั ะฝะฐะฒัะตะณะดะฐ ๐",
    "ะขั โ ะฒะดะพัะฝะพะฒะตะฝะธะต ะบะฐะถะดะพะน ะบะฐะฟะปะธ ะดะพะถะดั ๐ง๏ธ",
    "ะขั โ ะพะณะพะฝั, ััะพ ะฝะต ะพะฑะถะธะณะฐะตั ๐ฅ",
    "ะขั โ ัะฐะนะฝะฐ, ะบะพัะพััั ะฝะต ัะพัั ัะฐะทะณะฐะดะฐัั ๐"
]

# ะะพะดะฟะธัะธ
SIGNATURES = [
    "ะะฟะฐัะธ ัะตะฑั ะปัะฑะธั โค๏ธ",
    "ะขั ะฒ ัะตัะดัะต ะะฟะฐัะธ ะฝะฐะฒัะตะณะดะฐ ๐",
    "ะะพะปัะฑะธ ะะฟะฐัะธ, ะบะฐะบ ะพะฝ ัะตะฑั ๐",
    "ะั ะะฟะฐัะธ ั ัะตะฟะปะพะผ ๐",
]

# ะะธะฝะธ-ะฒะตะฑ-ัะตัะฒะตั Render
def run_web():
    class Handler(BaseHTTPRequestHandler):
        def do_GET(self):
            self.send_response(200)
            self.end_headers()
            self.wfile.write("LoveBot is running on Render <3".encode("utf-8"))

    port = int(os.environ.get("PORT", 10000))
    HTTPServer(("0.0.0.0", port), Handler).serve_forever()

threading.Thread(target=run_web, daemon=True).start()

# /start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(
        "๐ ะัะธะฒะตั! ะฏ LoveBot by Apachi.\n"
        "ะฏ ะฑัะดั ะพัะฒะตัะฐัั ะฝะฐ ะบะฐะถะดะพะต ัะพะพะฑัะตะฝะธะต @Habib471 ๐\n"
        "ะะพะผะฐะฝะดะพะน /love ะฒั ะผะพะถะตัะต ะฟัะพะฒะตัะธัั ัะพะฒะผะตััะธะผะพััั ั ะปัะฑัะผ ะฟะพะปัะทะพะฒะฐัะตะปะตะผ!"
    )

# ะัะฒะตั ะฝะฐ ัะพะพะฑัะตะฝะธั ะฒัะฑัะฐะฝะฝะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    message = update.message
    if not message or not message.from_user:
        return

    username = message.from_user.username
    if message.chat.type in ["group", "supergroup"] and username in TARGET_USERNAMES:
        phrase = random.choice(LOVE_PHRASES)
        signature = random.choice(SIGNATURES)
        response = f"{phrase}\n\n{signature}"
        await message.reply_text(response, reply_to_message_id=message.message_id)

# ะะพะผะฐะฝะดะฐ /love ะดะปั ะฒัะตั
async def love_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    message = update.message
    if not context.args or len(context.args) == 0:
        await message.reply_text("โ ะฃะบะฐะถะธ ะฟะพะปัะทะพะฒะฐัะตะปั, ะฝะฐะฟัะธะผะตั: /love @username")
        return

    target_username = context.args[0].lstrip('@')
    user1 = message.from_user.username or message.from_user.first_name
    user2 = target_username

    # ะกะปััะฐะนะฝะฐั ัะพะฒะผะตััะธะผะพััั
    score = random.randint(50, 100)
    phrase = random.choice(LOVE_PHRASES)
    signature = random.choice(SIGNATURES)

    await message.reply_text(
        f"๐ ะกะพะฒะผะตััะธะผะพััั {user1} ะธ {user2}: {score}% ๐\n\n{phrase}\n{signature}"
    )

def main():
    BOT_TOKEN = os.environ.get("BOT_TOKEN")
    if not BOT_TOKEN:
        print("โ ะัะธะฑะบะฐ: ะฟะตัะตะผะตะฝะฝะฐั BOT_TOKEN ะฝะต ะฝะฐะนะดะตะฝะฐ.")
        return

    app = ApplicationBuilder().token(BOT_TOKEN).build()
    app.add_handler(CommandHandler("start", start))
    app.add_handler(MessageHandler(filters.ALL, handle_message))
    app.add_handler(CommandHandler("love", love_command))

    print("๐ LoveBot by Apachi ะทะฐะฟััะตะฝ ะธ ะถะดัั ัะพะพะฑัะตะฝะธะน...")
    app.run_polling()

if __name__ == "__main__":
    main()
